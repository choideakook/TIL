# API ë©”ì‹œì§€ ë°”ë”” - JSON

ì´ì „ ê²Œì‹œë¬¼ì˜ text ë°©ì‹ì€ ì‚¬ì‹¤ ì£¼ë¡œ ì‚¬ìš©ë˜ëŠ” í˜•ì‹ì´ ì•„ë‹ˆë‹¤.

HTTP API ì—ì„œëŠ” ì£¼ë¡œ JSON í˜•ì‹ì„ ì‚¬ìš©í•œë‹¤.

## âœï¸Â JSON í˜•ì‹ ì „ì†¡

- POST
- content-type: application/json
- message body : {â€usernameâ€: â€œhelloâ€, â€œageâ€: 20}

### ğŸ“Â JSON í˜•ì‹ì˜ íŒŒì‹± ê°ì²´ ì¶”ê°€

- json í˜•ì‹ì˜ ê°ì²´ë¥¼ data ë¡œ ë³€í™˜í•˜ê¸° ìœ„í•´ ê°ì²´ë¥¼ ìƒì„±í•´ì¤€ë‹¤.
    - ìš”ì²­ ë©”ì‹œì§€ì˜ ê°’ì„ í•„ë“œì— ë‹´ëŠ” ì—­í• ì„ í•˜ëŠ” Class ì´ë‹¤.

```java
package com.example.servlet.basic;

import lombok.Getter;
import lombok.Setter;

@Getter @Setter
public class HelloData {

    private String username;
    private int age;
}
```

<br>

### ğŸ“Â Servlet Class ìƒì„±

- ì´ì „ì— ì‚¬ìš©í–ˆë˜ ê²ƒì²˜ëŸ¼ `getInputStream` ê³¼ `StreamUtils` ë¥¼ ì‚¬ìš©í•˜í•´ ìš”ì²­ data ê°’ì„ ì–»ì„ ìˆ˜ ìˆë‹¤.

```java
package com.example.servlet.basic.request;

import org.springframework.util.StreamUtils;

import javax.servlet.ServletException;
import javax.servlet.ServletInputStream;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.IOException;
import java.nio.charset.StandardCharsets;

@WebServlet(name = "requestBodyJsonServlet", urlPatterns = "/request-body-json")
public class RequestBodyJsonServlet extends HttpServlet {

    @Override
    protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        ServletInputStream inputStream = request.getInputStream();
        String messageBody = StreamUtils.copyToString(inputStream, StandardCharsets.UTF_8);

        System.out.println("messageBody = " + messageBody);
    }
}
```

ğŸ”Â ì¶œë ¥ë¬¼ í™•ì¸

- post man ì˜ ì„¤ì •ì„ raw ì˜ json ìœ¼ë¡œ ë³€ê²½í•œ ë’¤,
json í˜•ì‹ìœ¼ë¡œ ê°’ì„ ì…ë ¥í•˜ê³  send í•˜ë©´ ëœë‹¤.
- ê°’ì´ ì •ìƒì ìœ¼ë¡œ ì¶œë ¥ëœë‹¤.

```java
messageBody = {
    "username": "hello",
    "age": 20
}
```

<br>

### ğŸ“Â Json íŒŒì‹± ê°ì²´ì˜ í•„ë“œë¡œ ìš”ì²­ data íŒŒì‹± í•˜ê¸°

- ë‹¨ìˆœ text ë¡œ ê°’ì„ ë°›ì„ ê²½ìš° ê°’ì„ í•˜ë‚˜í•˜ë‚˜ ê°ì²´ë¡œ ìƒì„±í•˜ëŠ”ê²ƒì€ ë²ˆê±°ë¡­ë‹¤.
- JSON ì„ ì‚¬ìš©í•˜ë©´ ë¯¸ë¦¬ ìƒì„±í•´ë†“ì€ ê°ì²´ì˜ í•„ë“œê°’ì— ìš”ì²­ data ê°’ì„ íŒŒì‹±í•´ í¸ë¦¬í•˜ê²Œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
    - âš ï¸Â json ê²°ê³¼ë¥¼ íŒŒì‹±í•´ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” java ê°ì²´ë¡œ ë³€í™˜í•˜ë ¤ë©´ Jackson, Gson ë“±ë“± ì˜ ë³€í™˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•´ì•¼ í•œë‹¤.
        - Jackson ì€ Spring ì—ì„œ ê¸°ë³¸ìœ¼ë¡œ ì œê³µí•˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ ì´ë‹¤.

```java
    // Spring ì´ ê¸°ë³¸ìœ¼ë¡œ ì œê³µí•˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ì¸ 
    // Jackson ì˜ ObjectMapper ë¥¼ ìƒì„±í•œë‹¤.
    private ObjectMapper objectMapper = new ObjectMapper();

    @Override
    protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
        ServletInputStream inputStream = request.getInputStream();
        String messageBody = StreamUtils.copyToString(inputStream, StandardCharsets.UTF_8);

        System.out.println("messageBody = " + messageBody);

        // message body ì˜ ìš”ì²­ data ë¥¼ íŒŒì‹± ê°ì²´ì˜ í•„ë“œì— ë‹´ëŠ”ë‹¤.
        HelloData helloData = objectMapper.readValue(messageBody, HelloData.class);
        // data êº¼ë‚´ì„œ ì¶œë ¥í•˜ê¸°
        System.out.println("helloData.getUsername = " + helloData.getUsername());
        System.out.println("helloData.getAge = " + helloData.getAge());

        response.getWriter().write("200 OK");
```

ğŸ”Â ì¶œë ¥ë¬¼ í™•ì¸

- ì •ìƒì ìœ¼ë¡œ ì‘ë™í•œë‹¤.

```java
messageBody = {
    "username": "hello",
    "age": 20
}
helloData.getUsername = hello
helloData.getAge = 20
```

<br>

### âš ï¸Â HTTP Form ë°ì´í„°ë„ message body ë¥¼ í†µí•´ ì „ì†¡ë˜ê¸° ë•Œë¬¸ì— ì§€ê¸ˆ ë°©ì‹ìœ¼ë¡œ ì½ì„ ìˆ˜ ìˆë‹¤.

í•˜ì§€ë§Œ ì´ì „ ê²Œì‹œë¬¼ì˜ ë°©ë²•ì²˜ëŸ¼ í¸ë¦¬í•œ íŒŒë¦¬ë¯¸í„° ì¡°íšŒê¸°ëŠ¥ì„ ì œê³µí•˜ê¸° ë•Œë¬¸ì— íš¨ìœ¨ì ì¸ ë°©ë²•ì€ ì•„ë‹ˆë‹¤.

- JSON í˜•ì‹ì´ ì•„ë‹ˆê¸° ë•Œë¬¸ì— íŒŒì‹±ë„ ë¶ˆê°€ëŠ¥í•˜ë‹¤.

ğŸ”—Â HTTP Form ì¡°íšŒ ë°©ì‹