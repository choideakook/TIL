# MVC íŒ¨í„´ - ì ìš©

## âœï¸Â íšŒì› ë“±ë¡ í¼

### ğŸ“Â Controller

- í´ë¼ì´ì–¸íŠ¸ê°€ ìš”ì²­í•œ URL ì„ ë§µí•‘í•¨
- `dispatcher.forward()` : ë‹¤ë¥¸ ì„œë¸”ë¦¿ì´ë‚˜ JSP ë¥¼ í˜¸ì¶œí•˜ëŠ” ê¸°ëŠ¥
    - ì„œë¸”ë¦¿ì„ ìƒì„±í•˜ê³  ìš”ì²­, ì‘ë‹µ ì •ë³´ë¥¼ View ë¡œ ì „ë‹¬í•¨
    - âš ï¸Â ì„œë²„ ë‚´ë¶€ì—ì„œ ë‹¤ì‹œ í˜¸ì¶œì´ ë°œìƒí•œë‹¤.
    - URL ì´ ë³€ê²½ë˜ëŠ” ë¦¬ë‹¤ì´ë ‰íŠ¸ ê°œë…ì´ ì•„ë‹˜
        - `redirect` ëŠ” í´ë¼ì´ì–¸íŠ¸ì— ì‘ë‹µì´ ë‚˜ê°„ í›„ redirect ê²½ë¡œë¡œ ë‹¤ì‹œ ìš”ì²­í•´ ì´ë™ë˜ëŠ” ë°©ì‹ (URL ì´ ë³€ê²½ë¬ê¸° ë•Œë¬¸ì— í´ë¼ì´ì–¸íŠ¸ê°€ ì¸ì§€í•  ìˆ˜ ìˆë‹¤.)
        - `forward` ëŠ” method ë¥¼ í˜¸ì¶œí•˜ë“¯ ë‹¤ë¥¸ ê°ì²´ë¥¼ í˜¸ì¶œí•´ì„œ ì‹¤í–‰í•˜ëŠ” ë°©ì‹ì´ë‹¤.
    - ì‹¤ì§ˆì ìœ¼ë¡œ ì›¹ í˜ì´ì§€ì—ì„œëŠ” View ì˜ html ì½”ë“œê°€ ë Œë”ë§ ë¨

```java
package com.example.servlet.web.servletmvc;

import javax.servlet.RequestDispatcher;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.IOException;

/**
 * MVC íŒ¨í„´ì˜ Controller ì˜ ì—­í• 
 */
@WebServlet(name = "mvcMemberFormServlet", urlPatterns = "/servlet-mvc/members/new-form")
public class MvcMemberFormServlet extends HttpServlet {

    @Override
    protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {

        // view ê°€ ìœ„ì¹˜í•˜ê³  ìˆëŠ” ê²½ë¡œë¥¼ ì‚¬ìš©í•˜ê¸° ì‰½ê²Œ ë³€ìˆ˜ë¡œ ìƒì„±í•¨
        String viewPath = "/WEB-INF/views/new-form.jsp";

        // Controller ì—ì„œ View ë¡œ ì „ë‹¬í•˜ëŠ” ë¡œì§
        RequestDispatcher dispatcher = request.getRequestDispatcher(viewPath);
        dispatcher.forward(request, response);
    }
}
```

<br>

### ğŸ“Â HTML

- Controller ì—ì„œ path í•œ ê²½ë¡œì— íŒŒì¼ì„ ìƒì„±í•´ì•¼í•œë‹¤.
- í´ë¼ì´ì–¸íŠ¸ì˜ ìš”ì²­ì •ë³´ë¥¼ ì·¨í•©í•´ POST ë°©ì‹ìœ¼ë¡œ ë“±ë¡ ìš”ì²­í•œë‹¤.
    - url ì— / ì—†ì´ ê²½ë¡œê°€ ì í˜€ìˆëŠ”ê±¸ ìƒëŒ€ê²½ë¡œ ë¼ê³ í•œë‹¤.
    - ìƒëŒ€ê²½ë¡œë¡œ ì‘ì„±ì‹œ í˜„ì¬ ë””ë ‰í† ë¦¬ì— ìˆëŠ” íŒŒì¼ ì¤‘ì—ì„œë§Œ url ë§¤í•‘ì„ ì‹œë„í•œë‹¤.
        - ì¦‰, ì§€ê¸ˆ ìœ„ì¹˜í•œ `/servlet-mvc/members` ì—ì„œ `save` íŒŒì¼ì„ ì°¾ì•„ì„œ ë§¤í•‘í•¨
        - ëª¨ë“  ê²½ë¡œë¥¼ ì ì§€ì•Šì€ ìƒëŒ€ê²½ë¡œë¡œ ê°ì²´ë¥¼ ìƒì„±í•˜ë©´ ë‹¤ë¥¸ ë””ë ‰í† ë¦¬ì—ì„œë„ ì‚¬ìš©í•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ë‹¤ë¥¸ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ì—ì„œ ì½”ë“œ ì¬í™œìš©ì´ ê°€ëŠ¥í•´ì§„ë‹¤.

âš ï¸Â ***WEB-INF***

- í•´ë‹¹ ê²½ë¡œ í•˜ì— ìœ„ì¹˜í•œ íŒŒì¼ë“¤ì€ URL ì— ë””ë ‰í† ë¦¬ë¥¼ ì…ë ¥í•´ë„ ë Œë”ë§ ë˜ì§€ì•ŠìŒ
- ê¼­ Controller ì˜ í˜¸ì¶œì„ í†µí•´ì„œë§Œ ë Œë”ë§ì„ í•  ìˆ˜ ìˆìŒ

```html
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<html>
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>

<!-- ìƒëŒ€ê²½ë¡œ ì‚¬ìš©, [í˜„ì¬ URL ì´ ì†í•œ ê³„ì¸µ ê²½ë¡œ + /save] -->
<form action="save" method="post">
    username: <input type="text" name="username" />
    age: <input type="text" name="age" />
    <button type="submit">ì „ì†¡</button>
</form>

</body>
</html>
```

<br>

## âœï¸Â íšŒì› ì €ì¥ ì™„ë£Œ í˜ì´ì§€

### ğŸ“Â Controller

- ìš”ì²­ë°›ì€ param ê°’ì„ êº¼ë‚´ db ì— ì €ì¥í•¨
- ì €ì¥ëœ ê°’ì„ model ì— ì €ì¥í•¨
- forward ë¡œ jsp íŒŒì¼ì„ í˜¸ì¶œí•¨

```java
package com.example.servlet.web.servletmvc;

import com.example.servlet.domain.member.Member;
import com.example.servlet.domain.member.MemberRepository;

import javax.servlet.RequestDispatcher;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.IOException;

@WebServlet(name = "mvcMemberSaveServlet", urlPatterns = "/servlet-mvc/members/save")
public class MvcMemberSaveServlet extends HttpServlet {

    private MemberRepository repository = MemberRepository.getInstance();

    @Override
    protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {

        //-- business logic --//
        // parameter ë³€ìˆ˜ì— ì €ì¥
        String username = request.getParameter("username");
        int age = Integer.parseInt(request.getParameter("age"));
        // db ì— ì €ì¥
        Member member = new Member(username, age);
        repository.save(member);

        //-- Model ì— data ì €ì¥ê³¼ View í˜¸ì¶œ ë¡œì§ --//
        // jsp ì— ë„˜ê²¨ì¤„ ê°ì²´ë¥¼ ì…ë ¥ (ì…ë ¥ëœ ê°ì²´ëŠ” model ì— ì €ì¥ëœë‹¤.)
        request.setAttribute("member", member);

        // forward ë¡œ jsp í˜¸ì¶œ
        String viewPath = "/WEB-INF/views/save-result.jsp";
        RequestDispatcher dispatcher = request.getRequestDispatcher(viewPath);
        dispatcher.forward(request, response);
    }
}
```

<br>

### ğŸ“Â HTML

- ë™ì  HTML ì„ êµ¬í˜„í•˜ê¸° ìœ„í•´ Model ì—ì„œ member ë¥¼ êº¼ë‚´ ì‚¬ìš©í•¨

```html
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<html>
<head>
      <meta charset="UTF-8">
</head>
<body>
ì„±ê³µ
<ul>
    <li>id=${member.id}</li>
    <li>username=${member.username}</li>
    <li>age=${member.age}</li>
</ul>
<a href="/index.html">ë©”ì¸</a>
</body>
</html>
```

<br>

## âœï¸Â ëª¨ë“  íšŒì› ì¡°íšŒ

### ğŸ“Â Controller

```java
package com.example.servlet.web.servletmvc;

import com.example.servlet.domain.member.Member;
import com.example.servlet.domain.member.MemberRepository;

import javax.servlet.RequestDispatcher;
import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import java.io.IOException;
import java.util.List;

@WebServlet(name = "mvcMemberListServlet", urlPatterns = "/servlet-mvc/members")
public class MvcMemberListServlet extends HttpServlet {

    private MemberRepository repository = MemberRepository.getInstance();

    @Override
    protected void service(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {

        //-- business logic --//
        List<Member> members = repository.findAll();

        //-- Model ì— data ì €ì¥ê³¼ View í˜¸ì¶œ ë¡œì§ --//
        // model ì— ë„˜ê²¨ì¤„ data ì…ë ¥
        request.setAttribute("members", members);
        // JSP í˜¸ì¶œ
        String viewPath = "/WEB-INF/views/members.jsp";
        RequestDispatcher dispatcher = request.getRequestDispatcher(viewPath);
        dispatcher.forward(request, response);

    }
}
```

<br

### ğŸ“Â HTML

```html
<%@ page contentType="text/html;charset=UTF-8" language="java" %>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<html>
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<a href="/index.html">ë©”ì¸</a>
<table>
    <thead>
    <th>id</th>
    <th>username</th>
    <th>age</th>
    </thead>
    <tbody>
    <c:forEach var="item" items="${members}">
        <tr>
            <td>${item.id}</td>
            <td>${item.username}</td>
            <td>${item.age}</td>
        </tr>
    </c:forEach>
    </tbody>
</table>
</body>
</html>
```

<br>

## âœï¸Â MVC íŒ¨í„´ì˜ í•œê³„

- ì¤‘ë³µë¬¸ì œ
    - URL ì„ ë§¤í•‘í•´ì•¼í•˜ëŠ” `@WebServlet` ê´€ë ¨ ì½”ë“œì˜ ì‚¬ìš©ì´ ì¤‘ë³µëœë‹¤.
    - Controller ì—ì„œ JSP ë¥¼ í˜¸ì¶œí•˜ê¸° ìœ„í•œ `forward`  ì˜ ì‚¬ìš©ì´ ì¤‘ë³µëœë‹¤.
    - `view path` ì˜ ê²½ë¡œë„ ì¤‘ë³µì´ ëœë‹¤.
        - ë§Œì•½ íŒŒì¼ ê²½ë¡œë¥¼ ë³€ê²½í•˜ê²Œ ëœë‹¤ë©´ ëª¨ë“  Controller ì˜ ê²½ë¡œë¥¼ í•˜ë‚˜í•˜ë‚˜ ëª¨ë‘ ìˆ˜ì •í•´ì•¼ í•˜ëŠ” ë¬¸ì œê°€ ë°œìƒí•œë‹¤.
- ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ì½”ë“œ
    - Param ê°’ì´ ì—†ëŠ”ê²½ìš° request ê°€ ì‚¬ìš©ë˜ì§€ì•ŠëŠ”ë‹¤.
    - JSP ë¥¼ í˜¸ì¶œí•´ ì‘ë‹µí•˜ê¸° ë•Œë¬¸ì— response ëŠ” ì „í˜€ ì‚¬ìš©ë˜ì§€ ì•ŠëŠ”ë‹¤.
- Test ì½”ë“œ ì‘ì„±ì˜ ì–´ë ¤ì›€
- ê³µí†µì²˜ë¦¬ì˜ ì–´ë ¤ì›€
    - ê¸°ëŠ¥ì´ ë³µì¡í•´ì§ˆ ìˆ˜ ë¡ Controller ì—ì„œ ê³µí†µìœ¼ë¡œ ì²˜ë¦¬í•´ì•¼ í•˜ëŠ” ë¶€ë¶„ì´ ë” ë§ì•„ì§„ë‹¤.
    - ê³µí†µ ì²˜ë¦¬ ë¶€ë¶„ì„ method ë¡œ ë³€ê²½í•˜ë”ë¼ë„ í˜¸ì¶œí•˜ëŠ” ì½”ë“œ ìì²´ì˜ ì¤‘ë³µì€ í”¼í•  ìˆ˜ ì—†ë‹¤.

### ğŸ“Â ë¬¸ì œ í•´ê²°ë°©ë²•

MVC ì˜ ë¬¸ì œëŠ” ê³µí†µì²˜ë¦¬ì— ëŒ€í•œ ì¤‘ë³µì´ ê°€ì¥í¬ë‹¤.

ì´ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ì„  ê³µí†µìœ¼ë¡œ ì²˜ë¦¬í•´ì•¼ í•˜ëŠ” ê¸°ëŠ¥ì„  Controller ì˜ í˜¸ì¶œ ì „ì— ë¨¼ì € ì²˜ë¦¬í•˜ëŠ” ê²ƒìœ¼ë¡œ í•´ê²°í•  ìˆ˜ ìˆë‹¤.

***`Front Controller íŒ¨í„´`*** ì„ ì‚¬ìš©í•´ ì´ ë°©ì‹ìœ¼ë¡œ ë¬¸ì œë¥¼ í•´ê²°í•  ìˆ˜ ìˆë‹¤.

Spring MVC ì˜ í•µì‹¬ë„ ë°”ë¡œ ì´ Front Controller ì— ìˆë‹¤.
