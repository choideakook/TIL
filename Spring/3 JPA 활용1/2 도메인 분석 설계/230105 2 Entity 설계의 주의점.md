# Entity ì„¤ê³„ì˜ ì£¼ì˜ì 

### ğŸ“Â Entity ëŠ” ê°€ê¸‰ì  Setter ë¥¼ ì‚¬ìš©í•˜ì§€ ë§ì

- Setter ê°€ ëª¨ë‘ ì—´ë ¤ìˆë‹¤ë©´ ë³€ê²½í¬ì¸íŠ¸ê°€ ë„ˆë¬´ ë§ì•„ì„œ, ìœ ì§€ë³´ìˆ˜ê°€ ì–´ë µë‹¤.

<br>

### ğŸ“Â ëª¨ë“  ì—°ê´€ê´€ê³„ëŠ” ì§€ì—°ë¡œë”©ìœ¼ë¡œ ì„¤ì •

- ì¦‰ì‹œë¡œë”© (EAGR) ì€ ì˜ˆì¸¡ì´ ì–´ë µê³ , ì–´ë–¤ SQL ì´ ì‹¤í–‰ë ì§€ ì¶”ì í•˜ê¸° ì–´ë µë‹¤.
    - íŠ¹íˆ JPOL ì„ ì‹¤í–‰í•  ë•Œ N+1 ë¬¸ì œê°€ ìì£¼ ë°œìƒí•œë‹¤.
- ì‹¤ë¬´ì—ì„œ ëª¨ë“  ì—°ê´€ê´€ê³„ëŠ” ì§€ì—°ë¡œë”© (LAZY) ìœ¼ë¡œ ì„¤ì •í•´ì•¼ í•œë‹¤.
- ì—°ê´€ëœ Entity ë¥¼ í•¨ê»˜ DB ì—ì„œ ì¡°íšŒí•´ì•¼ í•˜ë©´, fetch join ë˜ëŠ” Entity ê·¸ë˜í”„ ê¸°ëŠ¥ì„ ì‚¬ìš©í•œë‹¤.
- âš ï¸ ***@OneToOne & ManyToOne*** ê´€ê³„ëŠ” ê¸°ë³¸ì´ ì¦‰ì‹œë¡œë”©ì´ë¯€ë¡œ ***ì§ì ‘ ì§€ì—°ë¡œë”©ìœ¼ë¡œ ì„¤ì •***í•´ì•¼ í•œë‹¤.
    - ì´ ë‘ ì—°ê´€ê´€ê³„ì˜ ì˜µì…˜ì€ ê¸°ë³¸ì´ ì¦‰ì‹œë¡œë”© (EAGR) ì´ê¸° ë•Œë¬¸ì— fetch = fetchType.LAZY ë¡œ ê¼­ ë°”ê¿”ì¤˜ì•¼í•œë‹¤.
    - @ ~ ToMany ëŠ” ê¸°ë³¸ê°’ì´ LAZY ì´ê¸° ë•Œë¬¸ì— ë³„ë„ ì„¤ì •ì„ í•´ì£¼ì§€ ì•Šì•„ë„ ëœë‹¤.

<br>

### ğŸ“Â Collection ì€ í•„ë“œì—ì„œ ì´ˆê¸°í™” í•˜ì

- Collection ì€ í•„ë“œì—ì„œ ë°”ë¡œ ì´ˆê¸°í™” í•˜ëŠ” ê²ƒì´ ì•ˆì „í•˜ë‹¤.
    - null ë¬¸ì œì—ì„œë„ ì•ˆì „í•˜ë‹¤.

```java
    // ì´ë ‡ê²Œí•˜ë©´ í•„ë“œì—ì„œ ì´ˆê¸°í™” ë¨
    @OneToMany (mappedBy = "member")
    private List<Order> orders = new ArrayList<>();

    // ì´ë ‡ê²Œí•˜ë©´ ë°”ë¡œ ì´ˆê¸°í™”ê°€ ì•ˆë˜ê³  null ë¬¸ì œë„ ë”°ë¡œ ì²´í¬í•´ì¤˜ì•¼í•¨
    @OneToMany (mappedBy = "member")
    private List<Order> orders;

        public Member (){
        orders = new ArrayList<>();
    }
```

- Hibernate ëŠ” Entity ë¥¼ ì˜ì†í™” í•  ë•Œ, Collection ì„ ê°ì‹¸ì„œ Hibernate ê°€ ì œê³µí•˜ëŠ” ë‚´ì¥ Collection ìœ¼ë¡œ ë³€ê²½í•œë‹¤.
    - ë§Œì•½ getOrders () ì²˜ëŸ¼ ì„ì˜ì˜ Method ì—ì„œ Collection ì„ ì˜ëª» ìƒì„±í•˜ë©´ Hibernate ë‚´ë¶€ ë©”ì»¤ë‹ˆì¦˜ì— ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ìˆì–´ì„œ í•„ë“œë ˆë²¨ì—ì„œ ìƒì„±í•˜ëŠ” ê²ƒì´ ê°€ì¥ ì•ˆì „í•˜ê³ , ê°„ê²°í•˜ë‹¤.

<br>

### ğŸ“Â cascade = CascadeType.ALL

cascade (ì˜ì†ì„± ì „ì˜)

íŠ¹ì • Entity ë¥¼ ì˜ì† ìƒíƒœë¡œ ë§Œë“¤ ë•Œ ì—°ê´€ëœ Entity ë„ í•¨ê»˜ ì˜ì† ìƒíƒœë¡œ ì „ì˜í•˜ëŠ” ê¸°ëŠ¥

- íŠ¹ì • Entity ì— ëŒ€í•œ ì‘ì—…ì„ ìˆ˜í–‰ì‹œ ê´€ë ¨ Entity ì—ë„ ë™ì¼í•œ ì‘ì—…ì´ ìˆ˜í–‰ëœë‹¤.
- ì˜ˆë¥¼ ë“¤ë©´ Order ì˜ orderItems ê°’ì´ 1:N ê´€ê³„ì´ë¯€ë¡œ ì—¬ëŸ¬ ê°œì¼ê²½ìš°,  
    orderItems ê° ê°’ì— ëŒ€í•´ persist ë¥¼ í•´ì£¼ê³ , order ë¥¼ persist í•´ì•¼í•˜ì§€ë§Œ,  
    cascade = all ë¡œ ì„¤ì •í•´ë†“ìœ¼ë©´ orderItems ê°’ë§Œ ì§€ì •ë˜ì–´ ìˆìœ¼ë©´ order ë§Œ persist í•´ë„ ëª¨ persist ëœë‹¤.
```java
@OneToMany(mappedBy = "order", cascade = ALL)
    private List<OrderItem> orderItems = new ArrayList<>();
```  
### âš ï¸ ê·¸ëŸ¼ ì™œ ëª¨ë“  ì—°ê´€ê´€ê³„ì— cascade ë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šê³  íŠ¹ì • ê´€ê³„ì—ë§Œ ì„¤ì •í• ê¹Œ?
- í˜„ì¬ í”„ë¡œì íŠ¸ì—ì„œëŠ” Order.orderItems ì™€ Order.delivery ì—ë§Œ cascade ë¥¼ ì„¤ì •í–ˆë‹¤.
    - ì¦‰, Order ë¥¼ ì‚­ì œí•˜ë©´ FK ë¡œ ì—°ê²°ëœ orderItems ì™€ delivery ë„ ì‚­ì œí•˜ê²Œëœë‹¤.
- Order.member ëŠ” ì™œ cascade ë¥¼ í•˜ì§€ ì•ŠëŠ”ê°€?
    - member ì—ë„ cascade ë¥¼ ì„¤ì •í•˜ë©´ Order ë¥¼ ì‚­ì œí•  ê²½ìš° member ì˜ data ë„ ì‚­ì œë˜ê²Œ ëœë‹¤.
    - ì¦‰, Order ì— ì˜í–¥ì„ ë°›ëŠ” ë¶€ë¶„ì— ëŒ€í•´ì„œë§Œ cascade ë¥¼ ì„¤ì •í•´ë‘ì–´ì•¼í•œë‹¤.
    - Order ê°€ ì·¨ì†Œë˜ë©´ í•´ë‹¹ Item ëª©ë¡ê³¼ ë°°ì†¡ì •ë³´ëŠ” ë”ì´ìƒ í•„ìš”í•˜ì§€ ì•Šë‹¤.
    - í•˜ì§€ë§Œ ì£¼ë¬¸ìì¸ Meber ì˜ data ëŠ” ê°€ì…ì„ í–ˆìœ¼ë‹ˆ Order ë¥¼ ì·¨ì†Œí•´ë„ ì‚­ì œë˜ì–´ì„  ì•ˆëœë‹¤.

<br>

- CascadeType.ALL
    - Cascade ì˜ ëª¨ë“  ê¸°ëŠ¥ì„ ì ìš©
- CascadeType.PERSIST
    - Entity ë¥¼ ì˜ì†í™” í•  ë•Œ, ì—°ê´€ëœ Entity ë„ í•¨ê»˜ ìœ ì§€
- CascadeType.MERGE
    - Entity ìƒíƒœë¥¼ ë³‘í•© (Merge) í•  ë•Œ , ì—°ê´€ëœ Entity ë„ ëª¨ë‘ ë³‘í•©
- CascadeType.REMOVE
    - Entity ë¥¼ ì œê±°í•  ë•Œ , ì—°ê´€ Entity ë„ ëª¨ë‘ ì œê±°
- CascadeType.DETACH
    - ë¶€ëª¨ Entity ë¥¼ detach () í•˜ë©´ , ì—°ê´€ Entity ë„ detach () ìƒíƒœê°€ ë˜ì–´ ë³€ê²½ ìƒí•­ ì ìš©ì´ ì•ˆë¨
- CascadeType.REFRESH
    - ìƒìœ„ Entity ë¥¼ ìƒˆë¡œê³ ì¹¨ í•  ë•Œ , ì—°ê´€ëœ Entity ë„ ëª¨ë‘ ìƒˆë¡œê³ ì¹¨ë¨

<br>

### ğŸ“Â ì—°ê´€ê´€ê³„ í¸ì˜ Method

ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„ì¼ ê²½ìš°ì— ê°’ì´ ìƒì„±ë˜ë©´ ê°’ì„ ê°ê°ì˜ í•„ë“œì— ì…ë ¥ì‹œì¼œì¤˜ì•¼ í•˜ì§€ë§Œ, ì—°ê´€ê´€ê³„ í¸ì˜ Method ë¥¼ ìƒì„±í•˜ë©´ í•˜ë‚˜ì˜ í•„ë“œê°’ë§Œ ì…ë ¥í•´ì¤˜ë„ ì—°ê²°ëœ ê°ì²´ì˜ í•„ë“œê°’ë„ ì±„ì›Œì§€ê²Œ ëœë‹¤.

<br>

ì—°ê´€ê´€ê³„ method ê°€ ì—†ë‹¤ë©´ ì´ëŸ°ì‹ìœ¼ë¡œ ê°ê°ì˜ í•„ë“œì— ë™ì¼í•œ ê°’ì„ ê°ê° ë„£ì–´ì¤˜ì•¼ í•œë‹¤.

- Member Entity ì™€ Order Entity ë¥¼ ì˜ˆë¡œ ë“¤ì—ˆìŒ

```java
    public static void main(String[] args) {
        Member member =new Member();
        Order order = new Order();
        
        member.getOrders().add(order);
        order.setMember(member);
    }
```

<br>

ì—°ê´€ê´€ê³„ method ë¥¼ ìƒì„±í•˜ë©´ í•˜ë‚˜ì˜ í•„ë“œê°’ë§Œ ìƒì„±í•´ì¤˜ë„ ë‹¤ë¥¸ í•„ë“œê°’ë„ ì±„ì›Œì§€ê²Œ ëœë‹¤.

```java
    public static void main(String[] args) {
        Member member =new Member();
        Order order = new Order();

        order.setMember(member);
    }
```

<br>

ì—°ê´€ê´€ê³„ í¸ì˜ method ìƒì„±

- ì—°ê´€ê´€ê³„ method ëŠ” í•µì‹¬ì ìœ¼ë¡œ ì»¨íŠ¸ë¡¤ í•˜ëŠ” ìª½ì— ìƒì„±í•´ì£¼ëŠ” ê²ƒì´ ì¢‹ë‹¤.
- Order Entity ì— ìƒì„±í•´ì£¼ì—ˆë‹¤

```java
//== ì—°ê´€ê´€ê³„ Method ==//

    public void setMember(Member member) {
        this.member = member;
        member.getOrders().add(this);
    }

    public void addOrderItem(OrderItem orderItem) {
        orderItems.add(orderItem);
        orderItem.setOrder(this);
    }

    public void setDelivery(Delivery delivery) {
        this.delivery = delivery;
        delivery.setOrder(this);
    }
```

- ìê¸° ìì‹ ê³¼ ì–‘ë°©í–¥ ì—°ê´€ê´€ê³„ë¥¼ ê°€ì§„ Category ë„ ìƒì„±
    - ë¶€ëª¨ ìì‹ ê°„ì— í¸ì˜ method ë¥¼ ìƒì„±í•´ì£¼ë©´ ëœë‹¤.

```java
    public void addChildCategory(Category child) {
        this.child.add(child);
        child.setParent(this);
    }
```
