# ì£¼ë¬¸ê³¼ í• ì¸ ë„ë©”ì¸ ê°œë°œ

## âœï¸Â  Discount Policy êµ¬í˜„

### 1. interfrce ì œì‘

- discount.DiscountPolicy (interface)

```java
package hello.core.discount;

import hello.core.member.Member;

public interface DiscountPolicy {

    /**
     * @return í• ì¸ ëŒ€ìƒ ê¸ˆì•¡
     */
    int discount(Member member, int price);

}
```

### 2. ì •ì•¡ í• ì¸ ì •ì±…

vip ì¼ ê²½ìš° 1,000 ì› í• ì¸ / ì¼ë°˜íšŒì›ì¼ê²½ìš° í• ì¸ ì—†ìŒ

```java
package hello.core.discount;

import hello.core.member.Grade;
import hello.core.member.Member;

public class FixDiscountPolicy implements DiscountPolicy{

    // VIP ëŒ€ìƒ 1,000 ì› í• ì¸
    private int discountFixAmount = 1000;

    @Override
    public int discount(Member member, int price) {
        // Enum í˜•íƒœ ë¹„êµëŠ” equal ì´ ì•„ë‹Œ == ìœ¼ë¡œ ì‚¬ìš©í•´ì•¼ í•œë‹¤.
        if (member.getGrade() == Grade.VIP) {
            return discountFixAmount;
        } else {
            return 0;
        }
    }
}
```

## âœï¸Â Order Service  êµ¬í˜„

### 1. Class Member ì •í•˜ê¸°

ğŸ“Â ê¸°ë³¸ì ì¸ ìƒì„±ìì™€ getter / setter

```java
package hello.core.order;

public class Order {

    private Long memberId;
    private String itemName;
    private int itemPrice;
    private int discountPrice;

    public Order(Long memberId, String itemName, int itemPrice, int discountPrice) {
        this.memberId = memberId;
        this.itemName = itemName;
        this.itemPrice = itemPrice;
        this.discountPrice = discountPrice;
    }

		... (getter / setter)
}
```

ğŸ“Â í• ì¸ê¸ˆì•¡ ì œì™¸ëœ ê¸ˆì•¡ê³¼ to String ìœ¼ë¡œ ì¶œë ¥ì‹œ ë³´ê¸° í¸í•˜ê²Œ ë³€ê²½ì‹œì¼œì¤Œ

```java
package hello.core.order;

public class Order {

    private Long memberId;
    private String itemName;
    private int itemPrice;
    private int discountPrice;

    public Order(Long memberId, String itemName, int itemPrice, int discountPrice) {
        this.memberId = memberId;
        this.itemName = itemName;
        this.itemPrice = itemPrice;
        this.discountPrice = discountPrice;
    }
		// í• ì¸ ê¸ˆì•¡ì´ ì œì™¸ëœ ìƒí’ˆ ê°€ê²©
		public int calculatePrice (){
        return itemPrice - discountPrice;
    }

		... (getter / setter)

		@Override
    public String toString() {
        return "Order{" +
                "memberId=" + memberId +
                ", itemName='" + itemName + '\'' +
                ", itemPrice=" + itemPrice +
                ", discountPrice=" + discountPrice +
                '}';
    }
}
```

### 2. interface ì œì‘

```java
package hello.core.order;

public interface OrderService {

    Order createOrder(Long memberId, String itemName, int itemPrice);
}
```

### 3. êµ¬í˜„ì²´ êµ¬í˜„

```java
package hello.core.order;

import hello.core.discount.DiscountPolicy;
import hello.core.discount.FixDiscountPolicy;
import hello.core.member.Member;
import hello.core.member.MemberRepository;
import hello.core.member.MemoryMemberRepositry;

public class OrderServiceImpl implements OrderService{

		// íšŒì› ì •ë³´ë¥¼ í™•ì¸í•˜ê¸°ìœ„í•´ repository ìƒì„±
    private final MemberRepository memberRepository = new MemoryMemberRepositry();
		// í• ì¸ ê¸ˆì•¡ì„ í™•ì¸í•˜ê¸°ìœ„í•´ discount policy ìƒì„±
    private final DiscountPolicy discountPolicy = new FixDiscountPolicy();

    @Override
    public Order createOrder(Long memberId, String itemName, int itemPrice) {
        
				// íšŒì› ì •ë³´ ê°€ì ¸ì˜¤ê¸°
        Member member = memberRepository.findById(memberId);
				// íšŒì› ë“±ê¸‰ì— ë”°ë¥¸ í• ì¸ ìœ¨ ê³„ì‚°ì„ ë„˜ê²¨ì¤Œ (itemPrice ëŠ” ì™œ í•„ìš”í•œê±°ì§€?)
        int discountPrice = discountPolicy.discount(member, itemPrice);
        // Order ì˜ member ë“¤ì—ê²Œ ìµœì¢… ìƒì„±ëœ ê°’ë“¤ì„ ë„˜ê²¨ì£¼ë©° ì£¼ë¬¸ì„ ìƒì„±í•¨
        return new Order(memberId, itemName, itemPrice, discountPrice);
    }
}
```

## âœï¸Â ì‹¤í–‰ê³¼ í…ŒìŠ¤íŠ¸

### 1. ìˆœìˆ˜ java ì½”ë“œ test

```java
package hello.core;

import hello.core.member.Grade;
import hello.core.member.Member;
import hello.core.member.MemberService;
import hello.core.member.MemberServiceImpl;
import hello.core.order.Order;
import hello.core.order.OrderService;
import hello.core.order.OrderServiceImpl;

public class OrderApp {
    public static void main(String[] args) {

        MemberService memberService = new MemberServiceImpl();
        OrderService orderService = new OrderServiceImpl();

        Long memberId = 1L;
        Member member = new Member(memberId, "MemberA", Grade.VIP);

        memberService.join(member);

        Order order = orderService.createOrder(memberId, "itemA", 10000);

        System.out.println("order = " + order);
				System.out.println("order.calculatePrice = " + order.calculatePrice());
    }
}
```

### 2. JUnit ìœ¼ë¡œ test ì§„í–‰

```java
package hello.core.order;

import hello.core.discount.DiscountPolicy;
import hello.core.discount.FixDiscountPolicy;
import hello.core.member.Grade;
import hello.core.member.Member;
import hello.core.member.MemberService;
import hello.core.member.MemberServiceImpl;
import org.assertj.core.api.Assertions;
import org.junit.jupiter.api.Test;

public class OrderServiceTest {

    MemberService memberService = new MemberServiceImpl();
    OrderService orderService = new OrderServiceImpl();

    @Test
    void createOrder (){
        Long memberId = 1L;
        Member member = new Member(memberId, "MembeerA", Grade.VIP);

        memberService.join(member);
        Order order = orderService.createOrder(memberId, "itemA", 10000);

        Assertions.assertThat(order.getDiscountPrice()).isEqualTo(1000);
    }
}
```